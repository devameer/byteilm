import{j as e}from"./charts-VrJjKkAO.js";import{i as f,c as k,r as n}from"./vendor-xoa7E_IC.js";import{b as w}from"./index-DX6VYCbL.js";import{F as v}from"./TrophyIcon-DQ4ORbod.js";import{F as x}from"./XCircleIcon-9LFgBkgf.js";import{F as _}from"./ArrowPathIcon-CglTX8eZ.js";import{F as h}from"./CheckCircleIcon-B3US9B7Y.js";const A=()=>{const{attemptId:i}=f(),l=k(),[s,b]=n.useState(null),[j,g]=n.useState(!0),[c,p]=n.useState(!0);n.useEffect(()=>{N()},[i]);const N=async()=>{var r,t;try{g(!0);const a=(await w.get(`/quiz-attempts/${i}/results`)).data;a.success?b(a.data):(alert(a.message),l(-1))}catch(d){console.error("Error fetching results:",d),alert("فشل تحميل النتائج: "+(((t=(r=d.response)==null?void 0:r.data)==null?void 0:t.message)||d.message))}finally{g(!1)}};if(j)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-red-600",children:"فشل تحميل النتائج"})});const y=r=>{const t={A:"text-green-600 dark:text-green-400",B:"text-blue-600 dark:text-blue-400",C:"text-yellow-600 dark:text-yellow-400",D:"text-orange-600 dark:text-orange-400",F:"text-red-600 dark:text-red-400"};return t[r]||t.F},u=(r,t)=>r>=t?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400";return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",dir:"rtl",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-5xl",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:s.passed?e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:e.jsx(v,{className:"w-12 h-12 text-green-600 dark:text-green-400"})}):e.jsx("div",{className:"w-20 h-20 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center",children:e.jsx(x,{className:"w-12 h-12 text-red-600 dark:text-red-400"})})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:s.passed?"مبروك! لقد نجحت":"للأسف، لم تنجح هذه المرة"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s.quiz_title})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"النتيجة"}),e.jsxs("p",{className:`text-3xl font-bold ${u(s.score,s.passing_score)}`,children:[s.score,"%"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"التقدير"}),e.jsx("p",{className:`text-3xl font-bold ${y(s.grade)}`,children:s.grade})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"النقاط"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[s.earned_points,"/",s.total_points]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"الوقت"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.time_spent})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:s.correct_answers}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجابات صحيحة"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:s.incorrect_answers}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجابات خاطئة"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.questions_count}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي الأسئلة"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx("span",{children:"النسبة المئوية"}),e.jsxs("span",{children:["درجة النجاح: ",s.passing_score,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${s.passed?"bg-green-600":"bg-red-600"}`,style:{width:`${Math.min(s.score,100)}%`}})})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:()=>l(-2),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"العودة للدرس"}),!s.passed&&e.jsxs("button",{onClick:()=>l(`/quizzes/${s.quiz_id}`),className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[e.jsx(_,{className:"w-5 h-5"}),"إعادة المحاولة"]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-6",children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"عرض الإجابات الصحيحة والتفسيرات"}),e.jsx("input",{type:"checkbox",checked:c,onChange:r=>p(r.target.checked),className:"w-5 h-5 text-blue-600"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"مراجعة الإجابات"}),s.questions.map((r,t)=>e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 border-r-4 ${r.is_correct?"border-green-500":"border-red-500"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["السؤال ",t+1]}),r.is_correct?e.jsx(h,{className:"w-6 h-6 text-green-600"}):e.jsx(x,{className:"w-6 h-6 text-red-600"})]}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:r.question})]}),e.jsxs("div",{className:"text-center mr-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"النقاط"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[r.points_earned,"/",r.points]})]})]}),r.type==="multiple_choice"&&r.options&&e.jsx("div",{className:"space-y-2 mb-4",children:r.options.map((d,a)=>{const m=r.user_answer===String(a),o=c&&r.correct_answer===String(a);return e.jsx("div",{className:`p-3 rounded-lg border-2 ${o?"border-green-500 bg-green-50 dark:bg-green-900/20":m&&!r.is_correct?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-200 dark:border-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:d}),o&&e.jsx(h,{className:"w-5 h-5 text-green-600"}),m&&!r.is_correct&&e.jsx(x,{className:"w-5 h-5 text-red-600"})]})},a)})}),(r.type==="fill_blank"||r.type==="short_answer")&&e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"إجابتك:"}),e.jsx("div",{className:`p-3 rounded-lg border-2 ${r.is_correct?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-red-500 bg-red-50 dark:bg-red-900/20"}`,children:e.jsx("p",{className:"text-gray-900 dark:text-white",children:r.user_answer||"لم يتم الإجابة"})})]}),c&&!r.is_correct&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"الإجابة الصحيحة:"}),e.jsx("div",{className:"p-3 rounded-lg border-2 border-green-500 bg-green-50 dark:bg-green-900/20",children:e.jsx("p",{className:"text-gray-900 dark:text-white",children:r.correct_answer})})]})]}),c&&r.explanation&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-1",children:"التفسير:"}),e.jsx("p",{className:"text-blue-800 dark:text-blue-200",children:r.explanation})]})]},r.question_id))]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:()=>l(-2),className:"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:"العودة للدرس"})})]})})};export{A as default};
