import{j as e}from"./charts-8gUIbWxc.js";import{b as l}from"./vendor-125d4HLq.js";import{b as z,u as Se}from"./index-DB2kzkDV.js";import{l as Ie}from"./lessonService-YJYph0J7.js";import{L as Me,C as Ee}from"./LessonMediaSkeleton-DPE0ddTS.js";import{B as W}from"./Button-Ce8BwJif.js";const U={async getVideos(s={}){return(await z.get("/media-library/videos",{params:s})).data},async uploadVideos(s){return(await z.post("/media-library/videos",s,{headers:{"Content-Type":"multipart/form-data"}})).data},async assignVideo(s,x){return(await z.post(`/media-library/videos/${s}/assign`,{lesson_id:x})).data},async detachVideo(s){return(await z.post(`/media-library/videos/${s}/detach`)).data},async deleteVideo(s){return(await z.delete(`/media-library/videos/${s}`)).data}};function ze({page:s=1,total:x=1,onPageChange:u,hasNext:D}){return e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4 text-sm text-gray-600",children:[e.jsxs("div",{children:["الصفحة ",s," من ",x]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>u==null?void 0:u(s-1),disabled:s<=1,className:"px-3 py-1.5 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"السابق"}),e.jsx("button",{type:"button",onClick:()=>u==null?void 0:u(s+1),disabled:!D,className:"px-3 py-1.5 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"التالي"})]})]})}const Ae=12,p="__uncategorized__",Le=s=>`https://img.youtube.com/vi/${s}/maxresdefault.jpg`;function De(){const{darkMode:s}=Se(),[x,u]=l.useState([]),[D,O]=l.useState(!0),[Z,B]=l.useState(null),[j,h]=l.useState(null),[N,A]=l.useState(1),[v,be]=l.useState({currentPage:1,totalPages:1,total:0,hasNext:!1}),[n,q]=l.useState({search:"",status:"all",courseId:"",categoryId:""}),[K,J]=l.useState(""),[w,he]=l.useState([]),[fe,X]=l.useState(!1),[f,ee]=l.useState(null),[L,$]=l.useState(""),[te,y]=l.useState(null),[b,V]=l.useState(""),[k,C]=l.useState(""),[g,se]=l.useState(null),[d,_]=l.useState(null),[G,re]=l.useState("grid"),[Y,ye]=l.useState({total:0,assigned:0,unassigned:0,totalSize:0}),ae=l.useMemo(()=>{const t=new Set;return x.forEach(r=>{var a;(a=r.lesson)!=null&&a.id&&t.add(String(r.lesson.id))}),t},[x]),oe=l.useMemo(()=>{const t=new Map;return w.forEach(r=>{const a=r.course,o=(a==null?void 0:a.id)??r.course_id;if(!o)return;const i=String(o);if(!t.has(i)){const c=(a==null?void 0:a.name)??(a==null?void 0:a.title)??r.course_name??`دورة رقم ${i}`;t.set(i,c)}}),Array.from(t.entries()).map(([r,a])=>({id:r,name:a})).sort((r,a)=>(r.name||"").localeCompare(a.name||"","ar",{sensitivity:"base"}))},[w]),pe=t=>{if(!t)return null;try{const r=t.trim(),a=/(?:youtube\.com\/(?:watch\?.*v=|embed\/|v\/)|youtu\.be\/)([A-Za-z0-9_-]{6,})/i,o=r.match(a);return o?o[1]:null}catch{return null}},S=t=>{if(!t)return null;if(t.thumbnail_url)return t.thumbnail_url;const r=pe(t.source_url);return r?Le(r):null},T=l.useMemo(()=>{const t={};return w.forEach(r=>{var m,R;const a=r.course_id?String(r.course_id):null;if(!a)return;const o=r.lesson_category_id??((m=r.category)!=null&&m.id?Number(r.category.id):null),i=o?String(o):p,c=o?((R=r.category)==null?void 0:R.name)??`تصنيف ${i}`:"بدون تصنيف";t[a]||(t[a]={}),t[a][i]||(t[a][i]=c)}),Object.fromEntries(Object.entries(t).map(([r,a])=>[r,Object.entries(a).map(([o,i])=>({id:o,name:i})).sort((o,i)=>(o.name||"").localeCompare(i.name||"","ar",{sensitivity:"base"}))]))},[w]),ie=l.useMemo(()=>n.courseId?(T[n.courseId]||[]).map(r=>({id:r.id,name:r.id===p?"بدون تصنيف":r.name})):[],[n.courseId,T]),I=l.useMemo(()=>b?T[b]||[]:[],[b,T]),P=l.useMemo(()=>I.some(t=>t.id!==p),[I]),H=l.useMemo(()=>{if(!P)return[];const t=I.filter(r=>r.id!==p);return I.some(r=>r.id===p)&&t.push({id:p,name:"بدون تصنيف"}),t},[I,P]),je=l.useMemo(()=>{const t=P;return w.filter(r=>{var c,m;if(b&&String(r.course_id)!==b)return!1;const a=String(r.id),o=((c=f==null?void 0:f.lesson)==null?void 0:c.id)&&String(f.lesson.id)===a;if(t&&!k&&!o)return!1;const i=r.lesson_category_id?String(r.lesson_category_id):(m=r.category)!=null&&m.id?String(r.category.id):p;return k&&!o&&i!==k?!1:o?!0:!ae.has(a)}).slice().sort((r,a)=>(r.name||"").localeCompare(a.name||"","ar",{sensitivity:"base"}))},[w,b,k,ae,f,P]);l.useEffect(()=>{if(!j)return;const t=setTimeout(()=>h(null),4e3);return()=>clearTimeout(t)},[j]);const le=l.useCallback(async()=>{var t;try{X(!0);const r=await Ie.getLessons();if(r!=null&&r.success){const a=Array.isArray(r.data)?r.data:[];he(a.slice().sort((o,i)=>(o.name||"").localeCompare(i.name||"","ar",{sensitivity:"base"})))}}catch(r){if((r==null?void 0:r.name)==="CanceledError"||(r==null?void 0:r.code)==="ERR_CANCELED"||(t=r==null?void 0:r.message)!=null&&t.includes("cancelled"))return;console.error("Failed to load lessons for media library:",r)}finally{X(!1)}},[]);l.useEffect(()=>(le(),()=>{}),[le]);const Ne=(t,r)=>{const a={page:t,per_page:Ae};return r.search&&(a.search=r.search),r.courseId&&(a.course_id=r.courseId),r.categoryId&&(a.category_id=r.categoryId),r.status==="assigned"?a.assigned=1:r.status==="unassigned"&&(a.unassigned=1),a},M=async(t=N,r=n)=>{var a,o;O(!0),B(null);try{const i=await U.getVideos(Ne(t,r));if((i==null?void 0:i.success)===!1){u([]),B((i==null?void 0:i.message)||"فشل تحميل مكتبة الوسائط"),O(!1);return}const c=Array.isArray(i==null?void 0:i.data)?i.data:[],m=(i==null?void 0:i.meta)||{};u(c),be({currentPage:m.current_page||t,totalPages:m.last_page||1,total:m.total??c.length??0,hasNext:(m.current_page||t)<(m.last_page||1)});const R={total:m.total??c.length??0,assigned:c.filter(E=>E.lesson).length,unassigned:c.filter(E=>!E.lesson).length,totalSize:c.reduce((E,Ce)=>E+(Ce.file_size||0),0)};ye(R)}catch(i){console.error("Error loading media library:",i),u([]);const c=((o=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:o.message)||(i==null?void 0:i.message)||"فشل تحميل مكتبة الوسائط";B(c)}finally{O(!1)}};l.useEffect(()=>{M(N,n)},[N,n.search,n.status,n.courseId,n.categoryId]);const F=(t,r)=>{q(a=>{const o={...a,[t]:r};return t==="courseId"&&(o.categoryId=""),o}),A(1)},ne=t=>{t.preventDefault(),F("search",K.trim())},de=()=>{J(""),q({search:"",status:"all",courseId:"",categoryId:""}),A(1)},ve=t=>{t<1||t>v.totalPages||A(t)},we=async()=>{h({type:"success",message:"تم رفع الفيديو إلى مكتبة الوسائط بنجاح"}),A(1),await M(1,n)},ce=t=>{if(ee(t),t.lesson){const r=String(t.lesson.course_id||""),a=t.lesson.lesson_category_id?String(t.lesson.lesson_category_id):p;V(r),C(a),$(String(t.lesson.id))}else V(""),C(""),$("");y(null)},Q=()=>{ee(null),V(""),C(""),$(""),y(null)},$e=async t=>{var r,a;if(t.preventDefault(),y(null),!L||!f){y("يرجى اختيار درس لربط الفيديو به.");return}try{const o=await U.assignVideo(f.id,L);o!=null&&o.success?(h({type:"success",message:o.message||"تم ربط الفيديو بالدرس بنجاح."}),Q(),await M(N,n)):y((o==null?void 0:o.message)||"فشل ربط الفيديو بالدرس.")}catch(o){y(((a=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:a.message)||"حدث خطأ أثناء ربط الفيديو.")}},xe=async t=>{var r,a;if(confirm("هل تريد فصل هذا الفيديو عن الدرس المرتبط به؟"))try{const o=await U.detachVideo(t);o!=null&&o.success?(h({type:"success",message:o.message||"تم فصل الفيديو عن الدرس."}),await M(N,n)):h({type:"error",message:o.message||"فشل فصل الفيديو عن الدرس."})}catch(o){h({type:"error",message:((a=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:a.message)||"حدث خطأ أثناء فصل الفيديو."})}},ge=async t=>{var r,a;if(confirm("هل أنت متأكد من حذف هذا الفيديو؟ هذا الإجراء لا يمكن التراجع عنه."))try{const o=await U.deleteVideo(t);o!=null&&o.success?(h({type:"success",message:o.message||"تم حذف الفيديو بنجاح."}),await M(N,n)):h({type:"error",message:o.message||"فشل حذف الفيديو."})}catch(o){h({type:"error",message:((a=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:a.message)||"حدث خطأ أثناء حذف الفيديو."})}},ke=t=>{se(t)},me=()=>{se(null)},ue=t=>{const r=new Date(t);return isNaN(r)?"تاريخ غير صالح":new Intl.DateTimeFormat("ar-EG",{year:"numeric",month:"long",day:"numeric"}).format(r)},_e=t=>{if(!t||t===0)return"0 بايت";const r=1024,a=["بايت","كيلوبايت","ميجابايت","جيجابايت"],o=Math.floor(Math.log(t)/Math.log(r));return Math.round(t/Math.pow(r,o)*100)/100+" "+a[o]};return e.jsxs("div",{className:`min-h-screen transition-colors duration-300 p-6 ${s?"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900":"bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30"}`,dir:"rtl",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-4xl font-black mb-2 transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:"مكتبة الوسائط"}),e.jsx("p",{className:`transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:"إدارة وتنظيم ملفات الفيديو الخاصة بك"})]}),e.jsxs("button",{onClick:()=>{const t=document.getElementById("upload-section");t==null||t.scrollIntoView({behavior:"smooth",block:"center"})},className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white rounded-xl font-bold hover:shadow-xl transition-all hover:scale-105 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt text-xl"}),e.jsx("span",{children:"رفع فيديو جديد"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:`rounded-xl shadow-sm border-2 p-6 hover:shadow-lg transition-all duration-300 ${s?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:"إجمالي الفيديوهات"}),e.jsx("p",{className:`text-3xl font-black transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:v.total})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-video text-white text-2xl"})})]})}),e.jsx("div",{className:`rounded-xl shadow-sm border-2 p-6 hover:shadow-lg transition-all duration-300 ${s?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:"مرتبطة بدروس"}),e.jsx("p",{className:`text-3xl font-black transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:Y.assigned})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-link text-white text-2xl"})})]})}),e.jsx("div",{className:`rounded-xl shadow-sm border-2 p-6 hover:shadow-lg transition-all duration-300 ${s?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:"غير مرتبطة"}),e.jsx("p",{className:`text-3xl font-black transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:Y.unassigned})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-unlink text-white text-2xl"})})]})}),e.jsx("div",{className:`rounded-xl shadow-sm border-2 p-6 hover:shadow-lg transition-all duration-300 ${s?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:"المساحة الإجمالية"}),e.jsx("p",{className:`text-3xl font-black transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:_e(Y.totalSize)})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-database text-white text-2xl"})})]})})]}),j&&e.jsxs("div",{className:`rounded-xl border-2 px-6 py-4 font-semibold flex items-center gap-3 transition-colors duration-300 ${j.type==="success"?s?"bg-emerald-900/30 border-emerald-700 text-emerald-300":"bg-emerald-50 border-emerald-200 text-emerald-700":s?"bg-red-900/30 border-red-700 text-red-300":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsx("i",{className:`fas ${j.type==="success"?"fa-check-circle":"fa-exclamation-circle"} text-xl`}),j.message]}),e.jsxs("div",{className:`rounded-2xl p-6 border-2 shadow-lg space-y-6 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:`text-xl font-black flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-100":"text-slate-800"}`,children:[e.jsx("i",{className:"fas fa-filter text-indigo-500"}),"البحث والتصفية"]}),e.jsxs("div",{className:`flex items-center gap-2 rounded-lg p-1 transition-colors duration-300 ${s?"bg-gray-700":"bg-slate-100"}`,children:[e.jsx("button",{onClick:()=>re("grid"),className:`px-4 py-2 rounded-md transition-all ${G==="grid"?s?"bg-gray-600 text-indigo-400 shadow-sm font-bold":"bg-white text-indigo-600 shadow-sm font-bold":s?"text-gray-400 hover:text-gray-200":"text-slate-600 hover:text-slate-900"}`,children:e.jsx("i",{className:"fas fa-th"})}),e.jsx("button",{onClick:()=>re("list"),className:`px-4 py-2 rounded-md transition-all ${G==="list"?s?"bg-gray-600 text-indigo-400 shadow-sm font-bold":"bg-white text-indigo-600 shadow-sm font-bold":s?"text-gray-400 hover:text-gray-200":"text-slate-600 hover:text-slate-900"}`,children:e.jsx("i",{className:"fas fa-list"})})]})]}),e.jsxs("form",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5",onSubmit:ne,onReset:de,children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-search transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"البحث عن فيديو"]}),e.jsx("input",{type:"text",value:K,onChange:t=>J(t.target.value),placeholder:"اسم الملف أو رابط المصدر...",className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200 placeholder-gray-500":"border-slate-200"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-check-circle transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"حالة الربط"]}),e.jsxs("select",{value:n.status,onChange:t=>F("status",t.target.value),className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200":"border-slate-200"}`,children:[e.jsx("option",{value:"",children:"جميع الفيديوهات"}),e.jsx("option",{value:"assigned",children:"مرتبطة بالدروس"}),e.jsx("option",{value:"unassigned",children:"غير مرتبطة"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-book transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"الدورة"]}),e.jsxs("select",{value:n.courseId,onChange:t=>F("courseId",t.target.value),className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200":"border-slate-200"}`,children:[e.jsx("option",{value:"",children:"كل الدورات"}),oe.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-folder transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"التصنيف"]}),e.jsxs("select",{value:n.categoryId,onChange:t=>F("categoryId",t.target.value),disabled:!n.courseId||!ie.length,className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200 disabled:bg-gray-800 disabled:text-gray-500":"border-slate-200 disabled:bg-gray-100 disabled:text-gray-400"}`,children:[e.jsx("option",{value:"",children:"كل التصنيفات"}),n.courseId&&ie.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(W,{type:"submit",variant:"primary",icon:"fa-search",onClick:ne,size:"lg",children:"بحث"}),e.jsx(W,{type:"reset",variant:"outline",icon:"fa-redo",onClick:de,size:"lg",children:"إعادة تعيين"})]})]}),e.jsx("div",{className:`rounded-2xl border-2 shadow-lg overflow-hidden transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:D?e.jsx(Me,{}):Z?e.jsxs("div",{className:`p-6 font-semibold flex items-center gap-3 transition-colors duration-300 ${s?"text-red-400":"text-red-600"}`,children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-2xl"}),Z]}):x.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 transition-colors duration-300 ${s?"bg-gray-700":"bg-slate-100"}`,children:e.jsx("i",{className:`fas fa-video text-3xl transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`})}),e.jsx("p",{className:`font-semibold transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"لا توجد فيديوهات في مكتبة الوسائط حالياً."})]}):e.jsxs(e.Fragment,{children:[G==="grid"?e.jsx("div",{className:"grid gap-6 p-6 sm:grid-cols-2 lg:grid-cols-3",children:x.map(t=>{const r=S(t);return e.jsxs("div",{className:`border-2 rounded-xl overflow-hidden hover:shadow-xl transition-all hover:scale-105 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:`relative aspect-video transition-colors duration-300 ${s?"bg-gradient-to-br from-gray-700 to-gray-800":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:[r?e.jsx("img",{src:r,alt:t.file_name||"Video thumbnail",className:"w-full h-full object-cover",onError:a=>{a.target.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:`fas fa-video text-5xl transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`})}),t.lesson&&e.jsxs("div",{className:"absolute top-3 right-3 px-3 py-1 bg-green-500 text-white rounded-full text-xs font-bold flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-link"}),"مرتبط"]})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("h3",{className:`font-bold line-clamp-1 transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,title:t.file_name,children:t.file_name||"فيديو بدون عنوان"}),e.jsxs("div",{className:`space-y-2 text-xs transition-colors duration-300 ${s?"text-gray-400":"text-slate-600"}`,children:[t.lesson&&e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors duration-300 ${s?"bg-green-900/30":"bg-green-50"}`,children:[e.jsx("i",{className:"fas fa-graduation-cap text-green-600"}),e.jsx("span",{className:`font-semibold transition-colors duration-300 ${s?"text-green-300":"text-green-700"}`,children:t.lesson.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fas fa-database transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`}),t.formatted_size||"غير متوفر"]}),t.formatted_duration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fas fa-clock transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`}),t.formatted_duration]}),t.created_at&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fas fa-calendar transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`}),ue(t.created_at)]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs("button",{type:"button",onClick:()=>_(t),className:`flex-1 px-3 py-2 text-sm border-2 rounded-lg font-bold transition-all hover:shadow-md ${s?"border-indigo-600 text-indigo-400 hover:bg-indigo-900/30":"border-indigo-200 text-indigo-600 hover:bg-indigo-50"}`,children:[e.jsx("i",{className:"fas fa-eye ml-1"}),"عرض سريع"]}),e.jsxs("button",{type:"button",onClick:()=>ce(t),className:`flex-1 px-3 py-2 text-sm border-2 rounded-lg font-bold transition-all hover:shadow-md ${s?"border-blue-600 text-blue-400 hover:bg-blue-900/30":"border-blue-200 text-blue-600 hover:bg-blue-50"}`,children:[e.jsx("i",{className:"fas fa-link ml-1"}),t.lesson?"تحديث":"ربط"]})]}),e.jsxs("div",{className:"flex gap-2",children:[t.lesson&&e.jsxs("button",{type:"button",onClick:()=>xe(t.id),className:`flex-1 px-3 py-2 text-sm border-2 rounded-lg font-bold transition-all ${s?"border-yellow-600 text-yellow-400 hover:bg-yellow-900/30":"border-yellow-200 text-yellow-600 hover:bg-yellow-50"}`,children:[e.jsx("i",{className:"fas fa-unlink ml-1"}),"فصل"]}),e.jsxs("button",{type:"button",onClick:()=>ge(t.id),className:`flex-1 px-3 py-2 text-sm border-2 rounded-lg font-bold transition-all ${s?"border-red-600 text-red-400 hover:bg-red-900/30":"border-red-200 text-red-600 hover:bg-red-50"}`,children:[e.jsx("i",{className:"fas fa-trash-alt ml-1"}),"حذف"]})]})]})]},t.id)})}):e.jsx("div",{className:`divide-y-2 transition-colors duration-300 ${s?"divide-gray-700":"divide-slate-100"}`,children:x.map(t=>e.jsx("div",{className:`p-6 transition-colors duration-300 ${s?"hover:bg-gray-700":"hover:bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:`w-32 h-20 rounded-lg flex-shrink-0 overflow-hidden transition-colors duration-300 ${s?"bg-gradient-to-br from-gray-700 to-gray-800":"bg-gradient-to-br from-slate-100 to-slate-200"}`,children:S(t)?e.jsx("img",{src:S(t),alt:t.file_name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:`fas fa-video text-2xl transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`font-bold mb-2 transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,children:t.file_name}),e.jsxs("div",{className:`flex flex-wrap gap-4 text-xs transition-colors duration-300 ${s?"text-gray-400":"text-slate-600"}`,children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:`fas fa-database transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`}),t.formatted_size||"غير متوفر"]}),t.formatted_duration&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:`fas fa-clock transition-colors duration-300 ${s?"text-gray-500":"text-slate-400"}`}),t.formatted_duration]}),t.lesson&&e.jsxs("span",{className:"flex items-center gap-1 text-green-600 font-bold",children:[e.jsx("i",{className:"fas fa-link"}),t.lesson.name]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>_(t),className:`px-4 py-2 text-sm border-2 rounded-lg font-bold transition-all ${s?"border-indigo-600 text-indigo-400 hover:bg-indigo-900/30":"border-indigo-200 text-indigo-600 hover:bg-indigo-50"}`,children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{onClick:()=>ce(t),className:`px-4 py-2 text-sm border-2 rounded-lg font-bold transition-all ${s?"border-blue-600 text-blue-400 hover:bg-blue-900/30":"border-blue-200 text-blue-600 hover:bg-blue-50"}`,children:e.jsx("i",{className:"fas fa-link"})}),t.lesson&&e.jsx("button",{onClick:()=>xe(t.id),className:`px-4 py-2 text-sm border-2 rounded-lg font-bold transition-all ${s?"border-yellow-600 text-yellow-400 hover:bg-yellow-900/30":"border-yellow-200 text-yellow-600 hover:bg-yellow-50"}`,children:e.jsx("i",{className:"fas fa-unlink"})}),e.jsx("button",{onClick:()=>ge(t.id),className:`px-4 py-2 text-sm border-2 rounded-lg font-bold transition-all ${s?"border-red-600 text-red-400 hover:bg-red-900/30":"border-red-200 text-red-600 hover:bg-red-50"}`,children:e.jsx("i",{className:"fas fa-trash-alt"})})]})]})},t.id))}),e.jsxs("div",{className:`px-6 pb-6 pt-4 border-t-2 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700":"bg-slate-50 border-slate-200"}`,children:[e.jsx(ze,{page:v.currentPage,total:v.totalPages,hasNext:v.hasNext,onPageChange:ve}),e.jsxs("div",{className:`mt-3 text-sm font-semibold transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:["إجمالي الفيديوهات: ",v.total]})]})]})}),e.jsxs("div",{id:"upload-section",className:`rounded-2xl border-2 shadow-lg overflow-hidden scroll-mt-6 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-cloud-upload-alt text-white text-2xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-white",children:"رفع فيديوهات جديدة"}),e.jsx("p",{className:"text-sm text-white/80",children:"أضف فيديوهات إلى مكتبة الوسائط"})]})]})}),e.jsx("div",{className:"p-6",children:e.jsx(Ee,{mode:"library",allowMultiple:!0,onUploadSuccess:we,title:"",description:"اختر فيديو واحداً أو أكثر (MP4, AVI, MOV, WMV, WebM) وسيتم رفعها بالتتابع."})})]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/50 px-4",children:e.jsxs("div",{className:`w-full max-w-md rounded-2xl shadow-2xl overflow-hidden transition-colors duration-300 ${s?"bg-gray-800":"bg-white"}`,children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-link"}),"ربط الفيديو بالدرس"]}),e.jsx("p",{className:"mt-1 text-sm text-white/80",children:f.file_name})]}),e.jsx("button",{type:"button",onClick:Q,className:"w-10 h-10 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center text-white",children:e.jsx("i",{className:"fas fa-times"})})]})}),e.jsxs("form",{className:"p-6 space-y-4",onSubmit:$e,children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-book transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"اختر الدورة"]}),e.jsxs("select",{value:b,onChange:t=>{V(t.target.value),$(""),C(""),y(null)},className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200":"border-slate-200"}`,children:[e.jsx("option",{value:"",children:"اختر الدورة"}),oe.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),b&&H.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-folder transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"اختر التصنيف"]}),e.jsxs("select",{value:k,onChange:t=>{C(t.target.value),$(""),y(null)},className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200":"border-slate-200"}`,children:[e.jsx("option",{value:"",children:"اختر التصنيف"}),H.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-bold mb-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("i",{className:`fas fa-graduation-cap transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`}),"اختر الدرس"]}),e.jsxs("select",{value:L,onChange:t=>{$(t.target.value),y(null)},disabled:!b||fe,className:`w-full rounded-lg border-2 px-4 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700 text-gray-200 disabled:bg-gray-800 disabled:text-gray-500":"border-slate-200 disabled:bg-gray-100 disabled:text-gray-400"}`,children:[e.jsx("option",{value:"",children:"اختر الدرس"}),je.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),te&&e.jsxs("div",{className:`text-sm rounded-lg px-4 py-3 flex items-center gap-2 border-2 transition-colors duration-300 ${s?"text-red-400 bg-red-900/30 border-red-700":"text-red-600 bg-red-50 border-red-200"}`,children:[e.jsx("i",{className:"fas fa-exclamation-circle"}),te]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Q,className:`px-6 py-3 rounded-lg border-2 font-bold transition-all ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"إلغاء"}),e.jsx(W,{type:"submit",variant:"primary",icon:"fa-link",disabled:!b||H.length>0&&!k||!L,size:"lg",children:"ربط الفيديو"})]})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4",onClick:me,children:e.jsxs("div",{className:`w-full max-w-4xl rounded-2xl shadow-2xl overflow-hidden transition-colors duration-300 ${s?"bg-gray-800":"bg-white"}`,onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-play-circle"}),"معاينة الفيديو"]}),e.jsx("p",{className:"text-sm text-white/80 mt-1",children:g.file_name})]}),e.jsx("button",{type:"button",onClick:me,className:"w-10 h-10 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center text-white",children:e.jsx("i",{className:"fas fa-times"})})]})}),e.jsx("div",{className:"bg-black",children:g.video_url?e.jsx("video",{src:g.video_url,controls:!0,autoPlay:!0,className:"w-full h-[480px] bg-black",children:"المستعرض لديك لا يدعم تشغيل الفيديو."},g.id):e.jsx("div",{className:"p-8 text-center text-white",children:"لا يتوفر رابط تشغيل لهذا الفيديو."})}),e.jsx("div",{className:`p-6 border-t-2 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700":"bg-slate-50 border-slate-200"}`,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"الحجم"}),e.jsx("p",{className:`font-bold transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,children:g.formatted_size||"غير متوفر"})]}),g.formatted_duration&&e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"المدة"}),e.jsx("p",{className:`font-bold transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,children:g.formatted_duration})]}),e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-slate-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"الحالة"}),e.jsx("p",{className:`font-bold ${g.lesson?"text-green-600":"text-orange-600"}`,children:g.lesson?"مرتبط":"غير مرتبط"})]}),g.lesson&&e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-800 border-green-700":"bg-white border-green-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"الدرس"}),e.jsx("p",{className:"text-green-600 font-bold line-clamp-1",children:g.lesson.name})]})]})})]})}),d&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>_(null),children:e.jsxs("div",{className:`rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transition-colors duration-300 ${s?"bg-gray-800":"bg-white"}`,onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-video text-white text-2xl"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-white",children:"عرض سريع"}),e.jsx("p",{className:"text-sm text-white/80",children:d.file_name})]})]}),e.jsx("button",{onClick:()=>_(null),className:"w-10 h-10 rounded-lg bg-white/20 hover:bg-white/40 flex items-center justify-center text-white transition-all hover:scale-110",children:e.jsx("i",{className:"fas fa-times text-xl"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[S(d)&&e.jsx("div",{className:`aspect-video rounded-xl overflow-hidden border-2 transition-colors duration-300 ${s?"border-gray-700":"border-slate-200"}`,children:e.jsx("img",{src:S(d),alt:d.file_name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:`text-sm font-black mb-3 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-slate-600"}`,children:[e.jsx("i",{className:"fas fa-info-circle text-indigo-500"}),"معلومات الملف"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700":"bg-slate-50 border-slate-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"الحجم"}),e.jsx("p",{className:`font-bold transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,children:d.formatted_size||"غير متوفر"})]}),d.formatted_duration&&e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700":"bg-slate-50 border-slate-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"المدة"}),e.jsx("p",{className:`font-bold transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,children:d.formatted_duration})]}),e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${s?"bg-gray-900 border-gray-700":"bg-slate-50 border-slate-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"تاريخ الرفع"}),e.jsx("p",{className:`font-bold text-sm transition-colors duration-300 ${s?"text-gray-100":"text-slate-900"}`,children:ue(d.created_at)})]}),e.jsxs("div",{className:`rounded-lg p-4 border-2 transition-colors duration-300 ${d.lesson?s?"bg-green-900/30 border-green-700":"bg-green-50 border-green-200":s?"bg-orange-900/30 border-orange-700":"bg-orange-50 border-orange-200"}`,children:[e.jsx("p",{className:`text-xs mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-slate-500"}`,children:"الحالة"}),e.jsx("p",{className:`font-bold ${d.lesson?"text-green-600":"text-orange-600"}`,children:d.lesson?"مرتبط بدرس":"غير مرتبط"})]})]})]}),d.lesson&&e.jsxs("div",{children:[e.jsxs("h4",{className:`text-sm font-black mb-3 flex items-center gap-2 transition-colors duration-300 ${s?"text-gray-300":"text-slate-600"}`,children:[e.jsx("i",{className:"fas fa-link text-green-500"}),"معلومات الربط"]}),e.jsx("div",{className:`border-2 rounded-lg p-4 transition-colors duration-300 ${s?"bg-green-900/30 border-green-700":"bg-green-50 border-green-200"}`,children:e.jsx("p",{className:`font-bold transition-colors duration-300 ${s?"text-green-300":"text-green-700"}`,children:d.lesson.name})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{onClick:()=>{_(null),ke(d)},className:"flex-1 px-6 py-3 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white rounded-xl font-bold hover:shadow-xl transition-all hover:scale-105 flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-play-circle"}),e.jsx("span",{children:"تشغيل الفيديو"})]}),e.jsx("button",{onClick:()=>_(null),className:`px-6 py-3 border-2 rounded-xl font-bold transition-all hover:shadow-md ${s?"border-gray-600 text-gray-300 hover:bg-gray-700 hover:border-gray-500":"border-slate-300 text-slate-700 hover:bg-slate-50 hover:border-slate-400"}`,children:"إغلاق"})]})]})]})})]})}export{De as default};
