import{j as e}from"./charts-VrJjKkAO.js";import{r as o}from"./vendor-xoa7E_IC.js";import{b as E,u as $}from"./index-DX6VYCbL.js";import{B as v}from"./Button-mFSk_wkY.js";const R={async getSummary(){return(await E.get("/referrals/summary")).data}},L=()=>{const{darkMode:s}=$();return e.jsxs("div",{className:"space-y-6 animate-pulse",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`h-8 rounded w-48 ${s?"bg-gray-700":"bg-gray-200"}`}),e.jsx("div",{className:`h-5 rounded w-64 ${s?"bg-gray-700":"bg-gray-200"}`})]})}),e.jsxs("div",{className:`rounded-2xl shadow-sm border p-6 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`h-6 rounded w-32 mb-4 ${s?"bg-gray-700":"bg-gray-200"}`}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:`h-20 rounded-lg ${s?"bg-gray-700":"bg-gray-200"}`}),e.jsx("div",{className:`h-20 rounded-lg ${s?"bg-gray-700":"bg-gray-200"}`})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(a=>e.jsxs("div",{className:`rounded-xl p-5 border transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`h-4 rounded w-24 mb-3 ${s?"bg-gray-700":"bg-gray-200"}`}),e.jsx("div",{className:`h-8 rounded w-16 ${s?"bg-gray-700":"bg-gray-200"}`})]},a))}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(a=>e.jsxs("div",{className:`rounded-xl shadow-sm border p-6 transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`h-6 rounded w-32 mb-4 ${s?"bg-gray-700":"bg-gray-200"}`}),e.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(l=>e.jsx("div",{className:`h-16 rounded-lg ${s?"bg-gray-700":"bg-gray-200"}`},l))})]},a))})]})};function D(){const{darkMode:s}=$(),[a,l]=o.useState(null),[w,_]=o.useState(!0),[y,c]=o.useState(""),[h,d]=o.useState("");o.useEffect(()=>{let r=!0;return(async()=>{var j,N,f;try{const t=await R.getSummary();t.success&&r?l(t.data):r&&c("تعذر تحميل بيانات الإحالات حالياً.")}catch(t){if(r){if((t==null?void 0:t.name)==="CanceledError"||(t==null?void 0:t.code)==="ERR_CANCELED")return;const n=((N=(j=t==null?void 0:t.response)==null?void 0:j.data)==null?void 0:N.message)||(t==null?void 0:t.message);n&&!n.includes("timeout")&&!n.includes("canceled")?c(n):((f=t==null?void 0:t.response)==null?void 0:f.status)>=500?c("حدث خطأ في الخادم. يرجى المحاولة لاحقاً"):t!=null&&t.response||console.error("Network error loading referrals:",t)}}finally{r&&_(!1)}})(),()=>{r=!1}},[]);const u=o.useCallback(r=>{if(r){if(!(navigator!=null&&navigator.clipboard)){d("متصفحك لا يدعم النسخ التلقائي، يرجى نسخ الرابط يدوياً."),setTimeout(()=>d(""),4e3);return}navigator.clipboard.writeText(r).then(()=>{d("تم نسخ الرابط إلى الحافظة ✅"),setTimeout(()=>d(""),2500)}).catch(()=>{d("تعذر نسخ الرابط تلقائياً، يمكنك نسخه يدوياً."),setTimeout(()=>d(""),4e3)})}},[]),i=(a==null?void 0:a.stats)||{},S=(a==null?void 0:a.points_balance)??0,k=(a==null?void 0:a.reward_type)||"points",p=(a==null?void 0:a.reward_points_per_referral)??0,g=(a==null?void 0:a.code)||"",x=(a==null?void 0:a.share_url)||"",m=Array.isArray(a==null?void 0:a.recent_referrals)?a.recent_referrals:[],b=Array.isArray(a==null?void 0:a.recent_visits)?a.recent_visits:[],C=o.useMemo(()=>[{label:"إجمالي الإحالات",value:i.total_referrals??0,icon:"fa-users",color:s?"bg-indigo-900/30 text-indigo-300":"bg-indigo-50 text-indigo-600"},{label:"قيد المعالجة",value:i.pending_referrals??0,icon:"fa-hourglass-half",color:s?"bg-amber-900/30 text-amber-300":"bg-amber-50 text-amber-600"},{label:"المكتملة",value:i.completed_referrals??0,icon:"fa-circle-check",color:s?"bg-blue-900/30 text-blue-300":"bg-blue-50 text-blue-600"},{label:"تمت مكافأتهم",value:i.rewarded_referrals??0,icon:"fa-gift",color:s?"bg-emerald-900/30 text-emerald-300":"bg-emerald-50 text-emerald-600"}],[i,s]);if(w)return e.jsx(L,{});if(y)return e.jsxs("div",{className:`p-8 rounded-xl shadow-sm border text-center transition-colors duration-300 ${s?"bg-gray-800 border-red-800":"bg-white border-red-200"}`,children:[e.jsx("i",{className:"fas fa-triangle-exclamation text-red-500 text-3xl mb-4"}),e.jsx("p",{className:`font-semibold mb-2 ${s?"text-red-400":"text-red-600"}`,children:y}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-500"}`,children:"يرجى المحاولة لاحقاً أو التواصل مع فريق الدعم في حال استمرار المشكلة."})]});if(!a)return null;const M=[{label:"إجمالي النقرات",value:i.clicks_total??0,icon:"fa-mouse-pointer"},{label:"زوار فريدون",value:i.clicks_unique??0,icon:"fa-user-check"},{label:"تحويلات ناجحة",value:i.clicks_converted??0,icon:"fa-user-plus"}];return e.jsx("div",{className:`min-h-screen transition-colors duration-300 ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:`rounded-2xl p-6 border shadow-sm transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold mb-1 transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:"برنامج الإحالات"}),e.jsx("p",{className:`transition-colors duration-300 ${s?"text-gray-400":"text-gray-600"}`,children:"شارك رابطك الشخصي، وامنح أصدقاءك تجربة رائعة مع الحصول على مكافآت لكل تسجيل ناجح."})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`text-sm transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:"رصيد النقاط"}),e.jsxs("div",{className:`text-2xl font-semibold transition-colors duration-300 ${s?"text-indigo-400":"text-indigo-600"}`,children:[Number(S).toLocaleString("en-US")," نقطة"]}),e.jsx("p",{className:`text-xs mt-1 transition-colors duration-300 ${s?"text-gray-500":"text-gray-400"}`,children:k==="points"&&p>0?`تحصل على ${p} نقطة عن كل إحالة ناجحة`:"تابع الإحصائيات لمعرفة مكافآتك"})]})]}),e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:`p-4 rounded-xl border transition-colors duration-300 ${s?"border-gray-700 bg-gray-900/50":"border-gray-200 bg-gray-50"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:"رمز الإحالة الخاص بك"}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:`font-mono text-lg font-semibold transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:g||"غير متوفر"}),g&&e.jsx(v,{variant:"outline",icon:"fa-copy",onClick:()=>u(g),children:"نسخ الرمز"})]})]}),e.jsxs("div",{className:`p-4 rounded-xl border transition-colors duration-300 ${s?"border-indigo-700 bg-indigo-900/30":"border-indigo-200 bg-indigo-50"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors duration-300 ${s?"text-indigo-400":"text-indigo-600"}`,children:"رابط المشاركة"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-3",children:[e.jsx("span",{className:`font-mono text-sm break-all transition-colors duration-300 ${s?"text-indigo-300":"text-indigo-700"}`,children:x||"غير متوفر"}),x&&e.jsx(v,{variant:"secondary",icon:"fa-share-alt",className:"mt-3 md:mt-0",onClick:()=>u(x),children:"نسخ الرابط"})]}),h&&e.jsxs("p",{className:`text-xs mt-2 flex items-center gap-2 transition-colors duration-300 ${s?"text-indigo-300":"text-indigo-700"}`,children:[e.jsx("i",{className:"fas fa-info-circle"}),h]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:C.map(r=>e.jsx("div",{className:`border rounded-2xl p-5 shadow-sm transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:r.label}),e.jsx("p",{className:`text-2xl font-bold mt-1 transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:Number(r.value||0).toLocaleString("en-US")})]}),e.jsx("span",{className:`p-3 rounded-xl ${r.color}`,children:e.jsx("i",{className:`fas ${r.icon}`})})]})},r.label))}),e.jsxs("div",{className:`rounded-2xl border p-6 shadow-sm transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:"أداء الرابط"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:M.map(r=>e.jsx("div",{className:`rounded-xl border p-4 transition-colors duration-300 ${s?"border-gray-700 bg-gray-900/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:r.label}),e.jsx("p",{className:`text-xl font-semibold mt-1 transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:Number(r.value||0).toLocaleString("en-US")})]}),e.jsx("span",{className:`p-2 rounded-lg border transition-colors duration-300 ${s?"bg-gray-800 text-indigo-400 border-indigo-700":"bg-white text-indigo-600 border-indigo-100"}`,children:e.jsx("i",{className:`fas ${r.icon}`})})]})},r.label))})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:`rounded-2xl border p-6 shadow-sm transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-lg font-semibold transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:"آخر الإحالات"}),e.jsxs("span",{className:`text-sm transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:["آخر ",m.length," إحالات مسجلة"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:`min-w-full divide-y text-sm ${s?"divide-gray-700":"divide-gray-200"}`,children:[e.jsx("thead",{className:`transition-colors duration-300 ${s?"bg-gray-900 text-gray-400":"bg-gray-50 text-gray-600"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"المستخدم"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"الحالة"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"المكافأة"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"التاريخ"})]})}),e.jsx("tbody",{className:`divide-y transition-colors duration-300 ${s?"divide-gray-700":"divide-gray-100"}`,children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:`px-3 py-6 text-center transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:"لم يتم تسجيل إحالات بعد."})}):m.map(r=>e.jsxs("tr",{className:`transition-colors duration-300 ${s?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsxs("td",{className:"px-3 py-3",children:[e.jsx("div",{className:`font-semibold transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:r.referred_name||"—"}),e.jsx("div",{className:"text-xs transition-colors duration-300 text-gray-500",children:r.referred_email||"—"})]}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-semibold transition-colors duration-300 ${r.status==="rewarded"?s?"bg-emerald-900/30 text-emerald-300":"bg-emerald-50 text-emerald-600":r.status==="completed"?s?"bg-indigo-900/30 text-indigo-300":"bg-indigo-50 text-indigo-600":s?"bg-amber-900/30 text-amber-300":"bg-amber-50 text-amber-600"}`,children:r.status==="pending"?"قيد المعالجة":r.status==="completed"?"مكتملة":r.status==="rewarded"?"تم منح المكافأة":"غير محدد"})}),e.jsx("td",{className:`px-3 py-3 transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:r.reward_type==="points"&&r.reward_value?`${Number(r.reward_value||0).toLocaleString("en-US")} نقطة`:"—"}),e.jsx("td",{className:"px-3 py-3 text-xs transition-colors duration-300 text-gray-500",children:r.rewarded_at||r.completed_at||r.created_at||"—"})]},r.id||Math.random()))})]})})]}),e.jsxs("div",{className:`rounded-2xl border p-6 shadow-sm transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-lg font-semibold transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:"أحدث النقرات"}),e.jsxs("span",{className:`text-sm transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:["آخر ",b.length," زيارات مسجلة"]})]}),e.jsx("div",{className:"space-y-4",children:b.length===0?e.jsx("div",{className:`text-center py-6 transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:"لم يتم تسجيل زيارات بعد."}):b.map(r=>e.jsxs("div",{className:`border rounded-xl p-4 transition-colors duration-300 ${s?"border-gray-700 bg-gray-900/50":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`font-semibold transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:r.ip_address||"عنوان غير معروف"}),e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-lg transition-colors duration-300 ${r.converted?s?"bg-emerald-900/30 text-emerald-300":"bg-emerald-100 text-emerald-700":s?"bg-gray-700 text-gray-400":"bg-gray-200 text-gray-600"}`,children:r.converted?"تحوّل ناجح":"زيارة فقط"})]}),e.jsxs("div",{className:`text-xs space-y-1 transition-colors duration-300 ${s?"text-gray-400":"text-gray-500"}`,children:[r.landing_page&&e.jsxs("div",{children:[e.jsx("i",{className:"fas fa-link ml-1 text-indigo-500"}),r.landing_page]}),r.created_at&&e.jsxs("div",{children:[e.jsx("i",{className:"fas fa-clock ml-1 text-indigo-500"}),r.created_at]}),r.converted_at&&e.jsxs("div",{children:[e.jsx("i",{className:"fas fa-check ml-1 text-emerald-500"}),"تحويل: ",r.converted_at]})]})]},r.id||Math.random()))})]})]}),e.jsxs("div",{className:`rounded-2xl border p-6 shadow-sm transition-colors duration-300 ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-3 transition-colors duration-300 ${s?"text-gray-100":"text-gray-900"}`,children:"كيف يعمل برنامج الإحالة؟"}),e.jsxs("ol",{className:`list-decimal list-inside space-y-2 text-sm transition-colors duration-300 ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("li",{children:"انسخ رابط الإحالة الخاص بك وشاركه مع أصدقائك عبر البريد أو منصات التواصل."}),e.jsx("li",{children:"عندما يقوم صديقك بالتسجيل عبر الرابط، يتم تسجيل الإحالة تلقائياً."}),e.jsx("li",{children:"بعد اكتمال التسجيل، تُضاف مكافأتك إلى رصيد النقاط ويمكنك متابعتها من هذه الصفحة."})]})]})]})})}export{D as default};
